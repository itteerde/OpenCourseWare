(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     36247,        909]
NotebookOptionsPosition[     34971,        863]
NotebookOutlinePosition[     35320,        878]
CellTagsIndexPosition[     35277,        875]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"c", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"best", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"operators", "=", 
   RowBox[{"{", 
    RowBox[{"Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numbersets", "=", 
   RowBox[{"Subsets", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
       "7", ",", "8", ",", "9"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", " ", 
     RowBox[{"Length", "[", "numbersets", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"results", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"False", ",", 
        SuperscriptBox["9", "4"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"currentSet", "=", 
      RowBox[{"numbersets", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"permutations", "=", 
      RowBox[{"Permutations", "[", "currentSet", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "permutations", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"op1", "=", "1"}], ",", 
          RowBox[{"op1", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "operators", "]"}]}], ",", 
          RowBox[{"op1", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"op2", "=", "1"}], ",", 
            RowBox[{"op2", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", "operators", "]"}]}], ",", 
            RowBox[{"op2", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"op3", "=", "1"}], ",", 
               RowBox[{"op3", "\[LessEqual]", " ", 
                RowBox[{"Length", "[", "operators", "]"}]}], ",", 
               RowBox[{"op3", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"c", "=", 
                 RowBox[{"c", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"1", " ", "-", " ", "2", " ", "-", " ", "3"}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"r", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ";", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"operators", "[", 
                    RowBox[{"[", "op1", "]"}], "]"}], "[", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "//", 
                  "Quiet"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"operators", "[", 
                    RowBox[{"[", "op2", "]"}], "]"}], "[", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "//", 
                  "Quiet"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"r", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"operators", "[", 
                    RowBox[{"[", "op3", "]"}], "]"}], "[", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "//", 
                  "Quiet"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"r", ">", "0"}], " ", "&&", " ", 
                    RowBox[{"IntegerQ", "[", "r", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], "=", "True"}], ";"}]}], 
                  "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"1", " ", "-", " ", "3", " ", "-", " ", "2"}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"r", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ";", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"operators", "[", 
                    RowBox[{"[", "op1", "]"}], "]"}], "[", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "//", 
                  "Quiet"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"operators", "[", 
                    RowBox[{"[", "op2", "]"}], "]"}], "[", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "//", 
                  "Quiet"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"r", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"operators", "[", 
                    RowBox[{"[", "op3", "]"}], "]"}], "[", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "//", 
                  "Quiet"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"r", ">", "0"}], " ", "&&", " ", 
                    RowBox[{"IntegerQ", "[", "r", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], "=", "True"}], ";"}]}], 
                  "]"}], "//", "Quiet"}], ";"}]}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "]"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FirstPosition", "[", 
            RowBox[{"results", ",", "False"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ">", 
         RowBox[{"best", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"best", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"FirstPosition", "[", 
               RowBox[{"results", ",", "False"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "currentSet"}],
            "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"FirstPosition", "[", 
              RowBox[{"results", ",", "False"}], "]"}], "-", "1"}], ",", 
            "currentSet"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.701963931670331*^9, 3.701963964392629*^9}, {
   3.701964683233118*^9, 3.7019646845525737`*^9}, 3.7020681931223044`*^9, {
   3.702111886868861*^9, 3.7021120926291175`*^9}, {3.7021121493968477`*^9, 
   3.70211218658066*^9}, {3.7021122374807625`*^9, 3.7021123568499513`*^9}, {
   3.702112394317157*^9, 3.702112435836363*^9}, {3.7021126177179623`*^9, 
   3.70211264610984*^9}, {3.702112852619894*^9, 3.7021129237304497`*^9}, {
   3.7021130258421645`*^9, 3.702113109290436*^9}, {3.7021132103256664`*^9, 
   3.7021132352180943`*^9}, {3.702113298230365*^9, 3.7021134851798654`*^9}, {
   3.7021135339719934`*^9, 3.7021136101774817`*^9}, {3.7021145079541883`*^9, 
   3.702114530627692*^9}, {3.70211458617519*^9, 3.7021146139776754`*^9}, {
   3.702114692897419*^9, 3.702114700694713*^9}, {3.7021150000123205`*^9, 
   3.7021150479462132`*^9}, 3.7021153790945616`*^9, {3.702115445892312*^9, 
   3.7021154651044083`*^9}, 3.702986553737479*^9, {3.7029903746572847`*^9, 
   3.702990375116625*^9}, {3.7029904212471514`*^9, 3.7029904264349747`*^9}, {
   3.702990507649906*^9, 3.7029905330724964`*^9}, {3.7029906372865615`*^9, 
   3.702990657023033*^9}, 3.7029908949194984`*^9, {3.7029909894729166`*^9, 
   3.7029910700300617`*^9}, {3.702991113600914*^9, 3.7029911398777885`*^9}, {
   3.702991203220187*^9, 3.702991228956595*^9}, {3.7029912730969753`*^9, 
   3.702991339209754*^9}, {3.7029913856762743`*^9, 3.7029914765007477`*^9}, {
   3.7029917370785475`*^9, 3.7029918597266026`*^9}, {3.7029919874923077`*^9, 
   3.702992022550528*^9}, {3.702992256069379*^9, 3.7029922675799828`*^9}, {
   3.7029924387740993`*^9, 3.702992459869217*^9}, {3.7029925673419523`*^9, 
   3.702992568359635*^9}, {3.7029926146486993`*^9, 3.7029926165698323`*^9}, {
   3.7029930944132442`*^9, 3.702993097635806*^9}, {3.7029931836475067`*^9, 
   3.7029932009324646`*^9}, {3.702993254368532*^9, 3.7029932544306965`*^9}, {
   3.702993575203535*^9, 3.702993588225148*^9}, {3.7029943265290284`*^9, 
   3.702994373040694*^9}, {3.7029958172503977`*^9, 3.7029958182189665`*^9}, {
   3.702995857479334*^9, 3.702995858704605*^9}, {3.7029959637930007`*^9, 
   3.7029959649731507`*^9}, {3.7029961443600826`*^9, 
   3.7029961562637043`*^9}, {3.7029961938646746`*^9, 
   3.7029962192251015`*^9}, {3.703004016740168*^9, 3.703004033322888*^9}, {
   3.7030040676988015`*^9, 3.7030040749211197`*^9}, {3.703004111334751*^9, 
   3.7030041391726475`*^9}, {3.7030584396200123`*^9, 3.703058447331348*^9}, {
   3.703058512125909*^9, 3.703058697181634*^9}, {3.7030587466040297`*^9, 
   3.7030587614320183`*^9}, {3.703058801294366*^9, 3.703058924593591*^9}, {
   3.703058960056292*^9, 3.7030589906863213`*^9}, {3.7030590398097506`*^9, 
   3.7030590413060136`*^9}, {3.7030590968388214`*^9, 3.703059145846203*^9}, 
   3.703059184597099*^9, {3.703059248239466*^9, 3.7030594348242064`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "9", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.7030594372799635`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "10", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "4"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.7030594373255844`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "12", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "5"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.7030594373676963`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "14", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "6"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.703059437412816*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "15", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "3", ",", "7"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.7030594386049843`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "28", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.703059441051993*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "35", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.703059441213421*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "37", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4", ",", "7"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.7030594413688335`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "40", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4", ",", "9"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.703059441447543*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "43", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "5", ",", "6"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.7030594414876523`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "51", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "5", ",", "8"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.7030035267025895`*^9, {3.7030041017532463`*^9, 3.703004140270021*^9}, 
   3.7030591059494915`*^9, 3.7030593211132936`*^9, 3.7030593513525677`*^9, 
   3.7030594415663595`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["c"], "Input",
 CellChangeTimes->{3.7030042756335993`*^9}],

Cell[BoxData["322560"], "Output",
 CellChangeTimes->{3.7030042764519625`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"try", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"currentSet", "=", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"c", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"best", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"operators", "=", 
      RowBox[{"{", 
       RowBox[{"Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"results", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"False", ",", 
        SuperscriptBox["9", "4"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"permutations", "=", 
      RowBox[{"Permutations", "[", "currentSet", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "permutations", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"op1", "=", "1"}], ",", 
          RowBox[{"op1", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "operators", "]"}]}], ",", 
          RowBox[{"op1", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"op2", "=", "1"}], ",", 
            RowBox[{"op2", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", "operators", "]"}]}], ",", 
            RowBox[{"op2", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"op3", "=", "1"}], ",", 
               RowBox[{"op3", "\[LessEqual]", " ", 
                RowBox[{"Length", "[", "operators", "]"}]}], ",", 
               RowBox[{"op3", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"c", "=", 
                 RowBox[{"c", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"operators", "[", 
                    RowBox[{"[", "op1", "]"}], "]"}], "\[Equal]", "Divide"}], 
                   " ", "&&", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"operators", "[", 
                    RowBox[{"[", "op2", "]"}], "]"}], "\[Equal]", "Divide"}], 
                   " ", "&&", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"operators", "[", 
                    RowBox[{"[", "op3", "]"}], "]"}], "\[Equal]", "Divide"}], 
                   " ", "&&", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"r", "=", 
                 RowBox[{
                  RowBox[{"operators", "[", 
                   RowBox[{"[", "op1", "]"}], "]"}], "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"r", "=", 
                 RowBox[{
                  RowBox[{"operators", "[", 
                   RowBox[{"[", "op2", "]"}], "]"}], "[", 
                  RowBox[{"r", ",", 
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"r", "=", 
                 RowBox[{
                  RowBox[{"operators", "[", 
                   RowBox[{"[", "op3", "]"}], "]"}], "[", 
                  RowBox[{"r", ",", 
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"r", ">", "0"}], " ", "&&", " ", 
                   RowBox[{"IntegerQ", "[", "r", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], "=", "True"}], ";"}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FirstPosition", "[", 
            RowBox[{"results", ",", "False"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ">", 
         RowBox[{"best", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"best", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"FirstPosition", "[", 
              RowBox[{"results", ",", "False"}], "]"}], "-", "1"}], ",", 
            "currentSet"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"FirstPosition", "[", 
              RowBox[{"results", ",", "False"}], "]"}], "-", "1"}], ",", 
            "currentSet"}], "}"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numbersets", "=", 
   RowBox[{"Subsets", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
       "7", ",", "8", ",", "9"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.702995251105177*^9, 3.7029953873644824`*^9}, 
   3.7029954214491034`*^9, 3.7029955304217887`*^9, 3.702995569404434*^9, {
   3.7029963213676567`*^9, 3.702996327932147*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"try", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "8", ",", "9"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7029953939499855`*^9, 3.702995405815538*^9}, {
  3.702995580107896*^9, 3.7029955886375685`*^9}, {3.7029962687477827`*^9, 
  3.702996347928301*^9}, {3.7029963812218285`*^9, 3.7029963824731226`*^9}, {
  3.7030030853385153`*^9, 3.703003088420019*^9}, {3.7030044679360223`*^9, 
  3.703004471678782*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "14", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "8", ",", "9"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.7030034538772364`*^9, 3.7030044184584618`*^9, 
  3.7030044722961817`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Permutations", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.70300150069928*^9, 3.7030015133439007`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.703001514760677*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"best", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"operators", "=", 
   RowBox[{"{", 
    RowBox[{"Plus", ",", "Subtract", ",", "Times", ",", "Divide"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numbersets", "=", 
   RowBox[{"Subsets", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
       "7", ",", "8", ",", "9"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "numbersets", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"results", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"False", ",", 
       SuperscriptBox["9", "4"]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"currentSet", "=", 
     RowBox[{"numbersets", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"permutations", "=", 
     RowBox[{"Permutations", "[", "currentSet", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "permutations", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"op1", "=", "1"}], ",", 
         RowBox[{"op1", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "operators", "]"}]}], ",", 
         RowBox[{"op1", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"op2", "=", "1"}], ",", 
           RowBox[{"op2", "\[LessEqual]", " ", 
            RowBox[{"Length", "[", "operators", "]"}]}], ",", 
           RowBox[{"op2", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"op3", "=", "1"}], ",", 
              RowBox[{"op3", "\[LessEqual]", " ", 
               RowBox[{"Length", "[", "operators", "]"}]}], ",", 
              RowBox[{"op3", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"c", "=", 
                RowBox[{"c", "+", "1"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"operators", "[", 
                    RowBox[{"[", "op1", "]"}], "]"}], "\[Equal]", "Divide"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"operators", "[", 
                    RowBox[{"[", "op2", "]"}], "]"}], "\[Equal]", "Divide"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"operators", "[", 
                    RowBox[{"[", "op3", "]"}], "]"}], "\[Equal]", "Divide"}], 
                  " ", "&&", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"r", "=", 
                RowBox[{
                 RowBox[{"operators", "[", 
                  RowBox[{"[", "op1", "]"}], "]"}], "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"r", "=", 
                RowBox[{
                 RowBox[{"operators", "[", 
                  RowBox[{"[", "op2", "]"}], "]"}], "[", 
                 RowBox[{"r", ",", 
                  RowBox[{
                   RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"r", "=", 
                RowBox[{
                 RowBox[{"operators", "[", 
                  RowBox[{"[", "op3", "]"}], "]"}], "[", 
                 RowBox[{"r", ",", 
                  RowBox[{
                   RowBox[{"permutations", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"r", ">", "0"}], " ", "&&", " ", 
                  RowBox[{"IntegerQ", "[", "r", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"results", "[", 
                    RowBox[{"[", "r", "]"}], "]"}], "=", "True"}], ";"}]}], 
                "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FirstPosition", "[", 
           RowBox[{"results", ",", "False"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ">", 
        RowBox[{"best", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"best", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"FirstPosition", "[", 
              RowBox[{"results", ",", "False"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "currentSet"}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"FirstPosition", "[", 
             RowBox[{"results", ",", "False"}], "]"}], "-", "1"}], ",", 
           "currentSet"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["4", "3"], " ", 
  RowBox[{"4", "!"}], " "}]], "Input",
 CellChangeTimes->{{3.7030048629826355`*^9, 3.7030049173233023`*^9}}],

Cell[BoxData["1536"], "Output",
 CellChangeTimes->{{3.7030048955408936`*^9, 3.7030049184651194`*^9}}]
}, Open  ]]
},
WindowSize->{905, 833},
WindowMargins->{{377, Automatic}, {118, Automatic}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 13131, 279, 741, "Input"],
Cell[CellGroupData[{
Cell[13736, 305, 364, 9, 22, "Print"],
Cell[14103, 316, 365, 9, 22, "Print"],
Cell[14471, 327, 365, 9, 22, "Print"],
Cell[14839, 338, 363, 9, 22, "Print"],
Cell[15205, 349, 365, 9, 22, "Print"],
Cell[15573, 360, 363, 9, 22, "Print"],
Cell[15939, 371, 363, 9, 22, "Print"],
Cell[16305, 382, 365, 9, 22, "Print"],
Cell[16673, 393, 363, 9, 22, "Print"],
Cell[17039, 404, 365, 9, 22, "Print"],
Cell[17407, 415, 365, 9, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17821, 430, 71, 1, 30, "Input"],
Cell[17895, 433, 77, 1, 30, "Output"]
}, Open  ]],
Cell[17987, 437, 7640, 179, 550, "Input"],
Cell[CellGroupData[{
Cell[25652, 620, 445, 8, 30, "Input"],
Cell[26100, 630, 261, 7, 22, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26398, 642, 189, 4, 30, "Input"],
Cell[26590, 648, 509, 15, 30, "Output"]
}, Open  ]],
Cell[27114, 666, 7546, 183, 570, "Input"],
Cell[CellGroupData[{
Cell[34685, 853, 166, 4, 30, "Input"],
Cell[34854, 859, 101, 1, 30, "Output"]
}, Open  ]]
}
]
*)

