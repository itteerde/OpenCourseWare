(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11855,        285]
NotebookOptionsPosition[     11215,        260]
NotebookOutlinePosition[     11566,        275]
CellTagsIndexPosition[     11523,        272]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"nOfK", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"Infinity", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "12099"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"primeFactors", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", " ", "@@@", " ", 
     RowBox[{"FactorInteger", "[", "n", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"productSumNumberQ", "[", "set_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Plus", " ", "@@", "set"}], "\[Equal]", 
    RowBox[{"Times", " ", "@@", " ", "set"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kOfNSet", "[", "set_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Length", "[", "set", "]"}], "+", 
    RowBox[{"Times", " ", "@@", " ", "set"}], "-", 
    RowBox[{"Plus", " ", "@@", " ", "set"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partition", "[", 
    RowBox[{"{", "x_", "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", "x", "}"}], "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"partition", "[", 
    RowBox[{"{", 
     RowBox[{"r__", ",", "x_"}], "}"}], "]"}], ":=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ReplaceList", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b___", ",", 
              RowBox[{"{", "S__", "}"}], ",", "a___"}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"b", ",", 
              RowBox[{"{", 
               RowBox[{"S", ",", "x"}], "}"}], ",", "a"}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"{", "S__", "}"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"S", ",", 
              RowBox[{"{", "x", "}"}]}], "}"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{"partition", "[", 
       RowBox[{"{", "r", "}"}], "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7018722516547785`*^9, 3.7018722519921103`*^9}, {
   3.701872327626725*^9, 3.7018723280287066`*^9}, {3.701872790826177*^9, 
   3.7018727916824284`*^9}, {3.7018800338101735`*^9, 3.701880034131067*^9}, 
   3.701881845399584*^9, {3.7018819234577208`*^9, 3.7018819235967183`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hits", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"n", "=", "4"}], ",", 
    RowBox[{"hits", "<", "12000"}], ",", 
    RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partitions", "=", 
      RowBox[{"partition", "[", 
       RowBox[{"primeFactors", "[", "n", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partitions", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"Times", ",", "partitions", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "partitions", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"kOfNSet", "[", 
          RowBox[{"partitions", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nOfK", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ">", "n"}], " ", "&&", " ", 
           RowBox[{"k", "\[LessEqual]", " ", "12000"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nOfK", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "=", "n"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"hits", "=", 
            RowBox[{"hits", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.701880085848645*^9, 3.701880092340738*^9}, {
   3.7018801325952826`*^9, 3.701880222084302*^9}, {3.7018802586925125`*^9, 
   3.7018805715219536`*^9}, {3.70188097185988*^9, 3.701880979560773*^9}, {
   3.7018812539299684`*^9, 3.701881253992415*^9}, {3.7018813174454627`*^9, 
   3.7018813216629586`*^9}, {3.701881408961027*^9, 3.7018814094324975`*^9}, {
   3.7018814853544073`*^9, 3.701881509954619*^9}, {3.701881563163556*^9, 
   3.7018815821833506`*^9}, 3.701881619533465*^9, {3.701881976061967*^9, 
   3.7018820240705395`*^9}, {3.701882652207797*^9, 3.701882686850478*^9}, {
   3.701883713917801*^9, 3.7018837304277554`*^9}, {3.701883891546275*^9, 
   3.701883901666107*^9}, {3.701883942393711*^9, 3.7018839857462997`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"12100\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \
\\\"8\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \
\\\"12\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"15\\\", \\\",\\\", \\\"16\\\
\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"18\\\", \
\\\",\\\", \\\"20\\\", \\\",\\\", \\\"24\\\", \\\",\\\", \\\"24\\\", \
\\\",\\\", \\\"24\\\", \\\",\\\", \\\"24\\\", \\\",\\\", \\\"24\\\", \
\\\",\\\", \\\"28\\\", \\\",\\\", \\\"27\\\", \\\",\\\", \\\"32\\\", \
\\\",\\\", \\\"30\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"32\\\", \
\\\",\\\", \\\"32\\\", \\\",\\\", \\\"32\\\", \\\",\\\", \\\"36\\\", \
\\\",\\\", \\\"36\\\", \\\",\\\", \\\"36\\\", \\\",\\\", \\\"42\\\", \
\\\",\\\", \\\"40\\\", \\\",\\\", \\\"40\\\", \\\",\\\", \\\"48\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"45\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"54\\\", \
\\\",\\\", \\\"60\\\", \\\",\\\", \\\"54\\\", \\\",\\\", \\\"56\\\", \
\\\",\\\", \\\"54\\\", \\\",\\\", \\\"60\\\", \\\",\\\", \\\"63\\\", \
\\\",\\\", \\\"60\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"12048\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) does not \
exist.\"",2,192,36,21634319587714231151,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.701884800657133*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"12102\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \
\\\"8\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \
\\\"12\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"15\\\", \\\",\\\", \\\"16\\\
\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"18\\\", \
\\\",\\\", \\\"20\\\", \\\",\\\", \\\"24\\\", \\\",\\\", \\\"24\\\", \
\\\",\\\", \\\"24\\\", \\\",\\\", \\\"24\\\", \\\",\\\", \\\"24\\\", \
\\\",\\\", \\\"28\\\", \\\",\\\", \\\"27\\\", \\\",\\\", \\\"32\\\", \
\\\",\\\", \\\"30\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"32\\\", \
\\\",\\\", \\\"32\\\", \\\",\\\", \\\"32\\\", \\\",\\\", \\\"36\\\", \
\\\",\\\", \\\"36\\\", \\\",\\\", \\\"36\\\", \\\",\\\", \\\"42\\\", \
\\\",\\\", \\\"40\\\", \\\",\\\", \\\"40\\\", \\\",\\\", \\\"48\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"45\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"54\\\", \
\\\",\\\", \\\"60\\\", \\\",\\\", \\\"54\\\", \\\",\\\", \\\"56\\\", \
\\\",\\\", \\\"54\\\", \\\",\\\", \\\"60\\\", \\\",\\\", \\\"63\\\", \
\\\",\\\", \\\"60\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"12048\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) does not \
exist.\"",2,192,37,21634319587714231151,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.701884800742921*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"12100\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"4\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"6\\\", \\\",\\\", \
\\\"8\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \
\\\"12\\\", \\\",\\\", \\\"12\\\", \\\",\\\", \\\"15\\\", \\\",\\\", \\\"16\\\
\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"16\\\", \\\",\\\", \\\"18\\\", \
\\\",\\\", \\\"20\\\", \\\",\\\", \\\"24\\\", \\\",\\\", \\\"24\\\", \
\\\",\\\", \\\"24\\\", \\\",\\\", \\\"24\\\", \\\",\\\", \\\"24\\\", \
\\\",\\\", \\\"28\\\", \\\",\\\", \\\"27\\\", \\\",\\\", \\\"32\\\", \
\\\",\\\", \\\"30\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"32\\\", \
\\\",\\\", \\\"32\\\", \\\",\\\", \\\"32\\\", \\\",\\\", \\\"36\\\", \
\\\",\\\", \\\"36\\\", \\\",\\\", \\\"36\\\", \\\",\\\", \\\"42\\\", \
\\\",\\\", \\\"40\\\", \\\",\\\", \\\"40\\\", \\\",\\\", \\\"48\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"45\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \
\\\",\\\", \\\"48\\\", \\\",\\\", \\\"48\\\", \\\",\\\", \\\"54\\\", \
\\\",\\\", \\\"60\\\", \\\",\\\", \\\"54\\\", \\\",\\\", \\\"56\\\", \
\\\",\\\", \\\"54\\\", \\\",\\\", \\\"60\\\", \\\",\\\", \\\"63\\\", \
\\\",\\\", \\\"60\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"12048\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"}\\\"}]\\) does not \
exist.\"",2,192,38,21634319587714231151,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.701884800755459*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,192,39,21634319587714231151,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.701884800769699*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"666.984375`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.701881462165514*^9, {3.701881504631898*^9, 3.7018815876431017`*^9}, 
   3.7018818293393974`*^9, 3.7018818746279316`*^9, 3.701882228509735*^9, 
   3.701882639381359*^9, 3.7018826795425835`*^9, 3.701882772511453*^9, 
   3.7018834976902704`*^9, 3.7018848010024357`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Take", "[", 
    RowBox[{"nOfK", ",", "12000"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.701884855710677*^9, 3.7018848959554663`*^9}}],

Cell[BoxData["7587457"], "Output",
 CellChangeTimes->{3.7018848970207005`*^9}]
}, Open  ]]
},
WindowSize->{1038, 1080},
WindowMargins->{{375, Automatic}, {-33, Automatic}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2388, 68, 126, "Input"],
Cell[CellGroupData[{
Cell[2971, 92, 2496, 56, 240, "Input"],
Cell[5470, 150, 1550, 24, 56, "Message"],
Cell[7023, 176, 1550, 24, 56, "Message"],
Cell[8576, 202, 1550, 24, 56, "Message"],
Cell[10129, 228, 339, 7, 21, "Message"],
Cell[10471, 237, 377, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10885, 249, 233, 5, 30, "Input"],
Cell[11121, 256, 78, 1, 63, "Output"]
}, Open  ]]
}
]
*)

